<template>
  <v-container class="fill-height">
    <v-row align="center" justify="center">
      <div class="d-flex flex-column justify-space-between align-center">
        <v-img
          src="https://cdn.vuetifyjs.com/images/parallax/material.jpg"
          width="1020"
        >
          <v-container class="fill-height">
            <v-row align="center" justify="center">
              <v-col class="text-center" cols="12">
                <v-card class="ma-5 pa-5" color="main" dark>
                  <v-text-field
                    label="Nombre de usuario"
                    :rules="errors"
                    v-model="name"
                    required
                  ></v-text-field>
                  <v-text-field
                    v-model="password"
                    label="ContraseÃ±a"
                    :rules="errors"
                    required
                  ></v-text-field>

                  <v-card-actions class="mt-5">
                    <v-btn small @click="testManager()">
                    <!--<v-btn small @click="logUser()">-->
                      <v-icon> mdi-account </v-icon>
                      Ingresar
                    </v-btn>

                    <v-btn small @click="sendRegister()">
                      <v-icon> mdi-account-multiple-plus </v-icon>
                      Crear cuenta
                    </v-btn>

                    <v-btn small color="red" @click="sendMain()">
                      <v-icon> mdi-close </v-icon>
                      Cancelar
                    </v-btn>
                  </v-card-actions>
                </v-card>
              </v-col>
            </v-row>
          </v-container>
        </v-img>
      </div>
    </v-row>
  </v-container>
</template>

<script>
export default {
  name: "Login",
  data: () => ({
    name: "",
    password: "",
    errors: [(value) => !!value || "Este campo es necesario"],
  }),
  methods: {
    testManager() {
      this.$router.push({ name: "Manager" }).catch(() => {
        console.log("Admin");
      });
    },
    sendRegister() {
      this.$router.push({ name: "Register" }).catch(() => {
        console.log("Register");
      });
    },
    sendMain() {
      this.$router.push({ name: "Main" }).catch(() => {
        console.log("Client");
      });
    },
    validateAccount() {
      if (this.$store.state.user.information.type === 1) {
        this.$router.push({ name: "Manager" }).catch(() => {
          console.log("Admin");
        });
      } else {
        this.sendMain();
      }
    },
    logUser() {
      this.$store.dispatch("setUser", {
        username: this.name,
        type: 1
      });
      this.validateAccount();
    },
  },
};
</script>

<style lang="css"></style>
